<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QuantLib: C:/dev/QuantLib/ql/math/randomnumbers/zigguratgaussianrng.hpp Source File</title>
<link rel="stylesheet" href="/styles/fonts.css" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../quantlibextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://www.quantlib.org">QuantLib</a>: a free/open-source library for quantitative finance
   <div id="projectnumber">fully annotated source code - version 1.38</div>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_958d2abebb9d0797c141a9841f9d5d39.html">ql</a></li><li class="navelem"><a class="el" href="../../dir_698d86e3e0747fb1a8afedc5f938ef15.html">math</a></li><li class="navelem"><a class="el" href="../../dir_08dbf4954aa1cb81823b74a3e8373ab9.html">randomnumbers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">zigguratgaussianrng.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="../../dd/dcf/zigguratgaussianrng_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/* -*- mode: c++; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span> </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">/*</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> Copyright (C) 2024 Ralf Konrad Eckel</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"></span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> This file is part of QuantLib, a free-software/open-source library</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> for financial quantitative analysts and developers - http://quantlib.org/</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"></span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> QuantLib is free software: you can redistribute it and/or modify it</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> under the terms of the QuantLib license.  You should have received a</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> copy of the license along with this program; if not, please email</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> &lt;quantlib-dev@lists.sf.net&gt;. The license is also available online at</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> &lt;http://quantlib.org/license.shtml&gt;.</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"></span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> This program is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"> FOR A PARTICULAR PURPOSE.  See the license for more details.</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment">*/</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment"></span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment">/*! \file zigguratgaussianrng.hpp</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment">    \brief Ziggurat Gaussian random-number generator</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">*/</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#ifndef quantlib_ziggurat_gaussian_rng_h</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#define quantlib_ziggurat_gaussian_rng_h</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;<a class="code" href="../../d5/de9/sample_8hpp.html">ql/methods/montecarlo/sample.hpp</a>&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keyword">namespace </span><a class="code hl_namespace" href="../../d5/d7b/namespace_quant_lib.html">QuantLib</a> {</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="comment"></span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="comment">    //! Gaussian random number generator</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="comment"></span><span class="comment">    /*! It uses the Ziggurat transformation to return a</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="comment">        normal distributed Gaussian deviate with average 0.0 and</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="comment">        standard deviation of 1.0, from a random integer</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="comment">        in the [0,0xffffffffffffffffULL]-interval like.</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="comment"></span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="comment">        For a more detailed description see the article</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="comment">        &quot;An Improved Ziggurat Method to Generate Normal Random Samples&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="comment">        by Jurgen A. Doornik</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="comment">        (https://www.doornik.com/research/ziggurat.pdf).</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="comment"></span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="comment">        The code here is inspired by the rust implementation in</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="comment">        https://github.com/rust-random/rand/blob/d42daabf65a3ceaf58c2eefc7eb477c4d5a9b4ba/rand_distr/src/normal.rs</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="comment">        and</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="comment">        https://github.com/rust-random/rand/blob/d42daabf65a3ceaf58c2eefc7eb477c4d5a9b4ba/rand_distr/src/utils.rs.</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="comment"></span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="comment">        Class RNG must implement the following interface:</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="comment">        \code</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="comment">            Real nextReal() const;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="comment">            std::uint64_t nextInt64() const;</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="comment">        \endcode</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="comment">        Currently, Xoshiro256StarStarUniformRng is the only RNG supporting this.</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="comment">    */</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    <span class="keyword">template</span> &lt;<span class="keyword">class</span> RNG&gt;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno"><a class="line" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html">   56</a></span>    <span class="keyword">class </span><a class="code hl_class" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html">ZigguratGaussianRng</a> {</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>      <span class="keyword">public</span>:</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno"><a class="line" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#ad6ae312199547dfd98f3b79b89a036f0">   58</a></span>        <span class="keyword">typedef</span> <a class="code hl_struct" href="../../d4/da1/struct_quant_lib_1_1_sample.html">Sample&lt;Real&gt;</a> <a class="code hl_typedef" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#ad6ae312199547dfd98f3b79b89a036f0">sample_type</a>;</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno"><a class="line" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#ad0732c183c96fec5ad83c4b928085fa1">   60</a></span>        <span class="keyword">explicit</span> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#ad0732c183c96fec5ad83c4b928085fa1">ZigguratGaussianRng</a>(<span class="keyword">const</span> RNG&amp; uint64Generator)</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>        : <a class="code hl_variable" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a9600c98697345efbe0a48b78b2700679">uint64Generator_</a>(uint64Generator) {}</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="comment"></span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="comment">        //! returns a sample from a Gaussian distribution</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno"><a class="line" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a1dd1acca2b223c8da6c27cad720cfc7d">   64</a></span><span class="comment"></span>        <a class="code hl_struct" href="../../d4/da1/struct_quant_lib_1_1_sample.html">sample_type</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a1dd1acca2b223c8da6c27cad720cfc7d">next</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> {<a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a97a3fedfd3fb15531808709d2e58073f">nextReal</a>(), 1.0}; }</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="comment"></span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="comment">        //! return a random number from a Gaussian distribution</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="comment"></span>        <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a97a3fedfd3fb15531808709d2e58073f">nextReal</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>      <span class="keyword">private</span>:</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno"><a class="line" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a9600c98697345efbe0a48b78b2700679">   70</a></span>        RNG <a class="code hl_variable" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a9600c98697345efbe0a48b78b2700679">uint64Generator_</a>;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno"><a class="line" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a83f8a4cb9abf4f592b57632e0db7130a">   72</a></span>        <span class="keyword">typedef</span> <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_typedef" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a83f8a4cb9abf4f592b57632e0db7130a">ZigguratTable</a>[257];</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a9bed188fd5d9a6679e94215c4cb25abe">pdf</a>(<a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> x) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="comment"></span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="comment">        //! compute a random number in the tail by hand</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="comment"></span>        <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#adbbc2c4d9288520c41c9387719d80721">zeroCase</a>(<a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> u) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a3024db4b1bb00939c4d6f485e33453a3">normR</a>() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>        <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a40d2462cc3a0aa4a8e8f28a78f5e630f">normX</a>(<span class="keywordtype">int</span> i) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>        <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a089721060fd46fc8b6b97925aeda52b7">normF</a>(<span class="keywordtype">int</span> i) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    };</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="keyword">template</span> &lt;<span class="keyword">class</span> RNG&gt;</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno"><a class="line" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a97a3fedfd3fb15531808709d2e58073f">   85</a></span>    <span class="keyword">inline</span> <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a97a3fedfd3fb15531808709d2e58073f">ZigguratGaussianRng&lt;RNG&gt;::nextReal</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>        <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>            <span class="comment">// As an optimisation we re-implement the conversion</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>            <span class="comment">// to a double in the interval (-1,1).</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>            <span class="comment">// From the remaining 12 most significant bits we use 8 to construct `i`.</span></div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>            <span class="comment">//</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>            <span class="comment">// This saves us generating a whole extra random number, while the added</span></div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>            <span class="comment">// precision of using 64 bits for double does not buy us much.</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>            std::uint64_t randomU64 = uint64Generator_.nextInt64();</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>            <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> u = 2.0 * (<a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a>(randomU64 &gt;&gt; 11) + 0.5) * (1.0 / <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a>(1ULL &lt;&lt; 53)) - 1.0;</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>            <span class="keyword">auto</span> i = (int)(randomU64 &amp; 0xff);</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>            <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> x = u * normX(i);</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span> </div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>            <span class="keywordflow">if</span> (std::abs(x) &lt; normX(i + 1)) {</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>                <span class="keywordflow">return</span> x;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>            }</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>            <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>                <span class="comment">// compute a random number in the tail by hand</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>                <span class="keywordflow">return</span> zeroCase(u);</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>            }</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>            <span class="keywordflow">if</span> (normF(i + 1) + (normF(i) - normF(i + 1) * uint64Generator_.nextReal()) &lt; pdf(x)) {</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>                <span class="keywordflow">return</span> x;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>            }</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>        }</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    }</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <span class="keyword">template</span> &lt;<span class="keyword">class</span> RNG&gt;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno"><a class="line" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#adbbc2c4d9288520c41c9387719d80721">  113</a></span>    <span class="keyword">inline</span> <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#adbbc2c4d9288520c41c9387719d80721">ZigguratGaussianRng&lt;RNG&gt;::zeroCase</a>(<a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> u)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        <span class="comment">// compute a random number in the tail by hand</span></div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>        <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> x, <a class="code hl_variable" href="../../d0/d70/andreasenhugevolatilityinterpl_8cpp.html#a18279dd4d4460f2130f7a45358c14ffa">y</a>;</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        <span class="keywordflow">do</span> {</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>            x = std::log(uint64Generator_.nextReal()) / normR();</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>            <a class="code hl_variable" href="../../d0/d70/andreasenhugevolatilityinterpl_8cpp.html#a18279dd4d4460f2130f7a45358c14ffa">y</a> = std::log(uint64Generator_.nextReal());</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>        } <span class="keywordflow">while</span> (-2.0 * <a class="code hl_variable" href="../../d0/d70/andreasenhugevolatilityinterpl_8cpp.html#a18279dd4d4460f2130f7a45358c14ffa">y</a> &lt; x * x);</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>        <span class="keywordflow">return</span> (u &lt; 0.0) ? x - normR() : normR() - x;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    }</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    <span class="keyword">template</span> &lt;<span class="keyword">class</span> RNG&gt;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno"><a class="line" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a9bed188fd5d9a6679e94215c4cb25abe">  125</a></span>    <span class="keyword">inline</span> <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a9bed188fd5d9a6679e94215c4cb25abe">ZigguratGaussianRng&lt;RNG&gt;::pdf</a>(<a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> x)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>        <span class="keywordflow">return</span> std::exp(-x * x / 2.0);</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    }</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    <span class="keyword">template</span> &lt;<span class="keyword">class</span> RNG&gt;</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno"><a class="line" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a3024db4b1bb00939c4d6f485e33453a3">  130</a></span>    <span class="keyword">inline</span> <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a3024db4b1bb00939c4d6f485e33453a3">ZigguratGaussianRng&lt;RNG&gt;::normR</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>        <span class="keywordflow">return</span> 3.654152885361008796;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    }</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    <span class="keyword">template</span> &lt;<span class="keyword">class</span> RNG&gt;</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno"><a class="line" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a40d2462cc3a0aa4a8e8f28a78f5e630f">  135</a></span>    <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a40d2462cc3a0aa4a8e8f28a78f5e630f">ZigguratGaussianRng&lt;RNG&gt;::normX</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>        <span class="keyword">static</span> <span class="keyword">const</span> ZigguratTable normX = {</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>            3.910757959537090045, 3.654152885361008796, 3.449278298560964462, 3.320244733839166074,</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>            3.224575052047029100, 3.147889289517149969, 3.083526132001233044, 3.027837791768635434,</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>            2.978603279880844834, 2.934366867207854224, 2.894121053612348060, 2.857138730872132548,</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>            2.822877396825325125, 2.790921174000785765, 2.760944005278822555, 2.732685359042827056,</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>            2.705933656121858100, 2.680514643284522158, 2.656283037575502437, 2.633116393630324570,</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>            2.610910518487548515, 2.589575986706995181, 2.569035452680536569, 2.549221550323460761,</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>            2.530075232158516929, 2.511544441625342294, 2.493583041269680667, 2.476149939669143318,</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>            2.459208374333311298, 2.442725318198956774, 2.426670984935725972, 2.411018413899685520,</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>            2.395743119780480601, 2.380822795170626005, 2.366237056715818632, 2.351967227377659952,</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>            2.337996148795031370, 2.324308018869623016, 2.310888250599850036, 2.297723348901329565,</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>            2.284800802722946056, 2.272108990226823888, 2.259637095172217780, 2.247375032945807760,</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>            2.235313384928327984, 2.223443340090905718, 2.211756642882544366, 2.200245546609647995,</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>            2.188902771624720689, 2.177721467738641614, 2.166695180352645966, 2.155817819875063268,</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>            2.145083634046203613, 2.134487182844320152, 2.124023315687815661, 2.113687150684933957,</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>            2.103474055713146829, 2.093379631137050279, 2.083399693996551783, 2.073530263516978778,</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>            2.063767547809956415, 2.054107931648864849, 2.044547965215732788, 2.035084353727808715,</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>            2.025713947862032960, 2.016433734904371722, 2.007240830558684852, 1.998132471356564244,</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>            1.989106007615571325, 1.980158896898598364, 1.971288697931769640, 1.962493064942461896,</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>            1.953769742382734043, 1.945116560006753925, 1.936531428273758904, 1.928012334050718257,</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>            1.919557336591228847, 1.911164563769282232, 1.902832208548446369, 1.894558525668710081,</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>            1.886341828534776388, 1.878180486290977669, 1.870072921069236838, 1.862017605397632281,</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>            1.854013059758148119, 1.846057850283119750, 1.838150586580728607, 1.830289919680666566,</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>            1.822474540091783224, 1.814703175964167636, 1.806974591348693426, 1.799287584547580199,</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>            1.791640986550010028, 1.784033659547276329, 1.776464495522344977, 1.768932414909077933,</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>            1.761436365316706665, 1.753975320315455111, 1.746548278279492994, 1.739154261283669012,</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>            1.731792314050707216, 1.724461502945775715, 1.717160915015540690, 1.709889657069006086,</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>            1.702646854797613907, 1.695431651932238548, 1.688243209434858727, 1.681080704722823338,</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>            1.673943330923760353, 1.666830296159286684, 1.659740822855789499, 1.652674147080648526,</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>            1.645629517902360339, 1.638606196773111146, 1.631603456932422036, 1.624620582830568427,</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>            1.617656869570534228, 1.610711622367333673, 1.603784156023583041, 1.596873794420261339,</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>            1.589979870021648534, 1.583101723393471438, 1.576238702733332886, 1.569390163412534456,</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>            1.562555467528439657, 1.555733983466554893, 1.548925085471535512, 1.542128153226347553,</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>            1.535342571438843118, 1.528567729435024614, 1.521803020758293101, 1.515047842773992404,</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>            1.508301596278571965, 1.501563685112706548, 1.494833515777718391, 1.488110497054654369,</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>            1.481394039625375747, 1.474683555695025516, 1.467978458615230908, 1.461278162507407830,</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>            1.454582081885523293, 1.447889631277669675, 1.441200224845798017, 1.434513276002946425,</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>            1.427828197027290358, 1.421144398672323117, 1.414461289772464658, 1.407778276843371534,</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>            1.401094763676202559, 1.394410150925071257, 1.387723835686884621, 1.381035211072741964,</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>            1.374343665770030531, 1.367648583594317957, 1.360949343030101844, 1.354245316759430606,</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>            1.347535871177359290, 1.340820365893152122, 1.334098153216083604, 1.327368577624624679,</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>            1.320630975217730096, 1.313884673146868964, 1.307128989027353860, 1.300363230327433728,</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>            1.293586693733517645, 1.286798664489786415, 1.279998415710333237, 1.273185207661843732,</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>            1.266358287014688333, 1.259516886060144225, 1.252660221891297887, 1.245787495544997903,</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>            1.238897891102027415, 1.231990574742445110, 1.225064693752808020, 1.218119375481726552,</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>            1.211153726239911244, 1.204166830140560140, 1.197157747875585931, 1.190125515422801650,</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>            1.183069142678760732, 1.175987612011489825, 1.168879876726833800, 1.161744859441574240,</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>            1.154581450355851802, 1.147388505416733873, 1.140164844363995789, 1.132909248648336975,</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>            1.125620459211294389, 1.118297174115062909, 1.110938046009249502, 1.103541679420268151,</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>            1.096106627847603487, 1.088631390649514197, 1.081114409698889389, 1.073554065787871714,</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>            1.065948674757506653, 1.058296483326006454, 1.050595664586207123, 1.042844313139370538,</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>            1.035040439828605274, 1.027181966030751292, 1.019266717460529215, 1.011292417434978441,</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>            1.003256679539591412, 0.995156999629943084, 0.986990747093846266, 0.978755155288937750,</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>            0.970447311058864615, 0.962064143217605250, 0.953602409875572654, 0.945058684462571130,</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>            0.936429340280896860, 0.927710533396234771, 0.918898183643734989, 0.909987953490768997,</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>            0.900975224455174528, 0.891855070726792376, 0.882622229578910122, 0.873271068082494550,</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>            0.863795545546826915, 0.854189171001560554, 0.844444954902423661, 0.834555354079518752,</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>            0.824512208745288633, 0.814306670128064347, 0.803929116982664893, 0.793369058833152785,</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>            0.782615023299588763, 0.771654424216739354, 0.760473406422083165, 0.749056662009581653,</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>            0.737387211425838629, 0.725446140901303549, 0.713212285182022732, 0.700661841097584448,</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>            0.687767892786257717, 0.674499822827436479, 0.660822574234205984, 0.646695714884388928,</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>            0.632072236375024632, 0.616896989996235545, 0.601104617743940417, 0.584616766093722262,</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>            0.567338257040473026, 0.549151702313026790, 0.529909720646495108, 0.509423329585933393,</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>            0.487443966121754335, 0.463634336771763245, 0.437518402186662658, 0.408389134588000746,</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>            0.375121332850465727, 0.335737519180459465, 0.286174591747260509, 0.215241895913273806,</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>            0.000000000000000000};</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        <span class="keywordflow">return</span> normX[i];</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    }</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <span class="keyword">template</span> &lt;<span class="keyword">class</span> RNG&gt;</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno"><a class="line" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a089721060fd46fc8b6b97925aeda52b7">  206</a></span>    <a class="code hl_typedef" href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">Real</a> <a class="code hl_function" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a089721060fd46fc8b6b97925aeda52b7">ZigguratGaussianRng&lt;RNG&gt;::normF</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        <span class="keyword">static</span> <span class="keyword">const</span> <a class="code hl_class" href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html">ZigguratGaussianRng&lt;RNG&gt;::ZigguratTable</a> normF = {</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>            0.000477467764586655, 0.001260285930498598, 0.002609072746106363, 0.004037972593371872,</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>            0.005522403299264754, 0.007050875471392110, 0.008616582769422917, 0.010214971439731100,</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>            0.011842757857943104, 0.013497450601780807, 0.015177088307982072, 0.016880083152595839,</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>            0.018605121275783350, 0.020351096230109354, 0.022117062707379922, 0.023902203305873237,</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>            0.025705804008632656, 0.027527235669693315, 0.029365939758230111, 0.031221417192023690,</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>            0.033093219458688698, 0.034980941461833073, 0.036884215688691151, 0.038802707404656918,</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>            0.040736110656078753, 0.042684144916619378, 0.044646552251446536, 0.046623094902089664,</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>            0.048613553216035145, 0.050617723861121788, 0.052635418276973649, 0.054666461325077916,</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>            0.056710690106399467, 0.058767952921137984, 0.060838108349751806, 0.062921024437977854,</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>            0.065016577971470438, 0.067124653828023989, 0.069245144397250269, 0.071377949059141965,</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>            0.073522973714240991, 0.075680130359194964, 0.077849336702372207, 0.080030515814947509,</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>            0.082223595813495684, 0.084428509570654661, 0.086645194450867782, 0.088873592068594229,</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>            0.091113648066700734, 0.093365311913026619, 0.095628536713353335, 0.097903279039215627,</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>            0.100189498769172020, 0.102487158942306270, 0.104796225622867056, 0.107116667775072880,</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>            0.109448457147210021, 0.111791568164245583, 0.114145977828255210, 0.116511665626037014,</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>            0.118888613443345698, 0.121276805485235437, 0.123676228202051403, 0.126086870220650349,</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>            0.128508722280473636, 0.130941777174128166, 0.133386029692162844, 0.135841476571757352,</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>            0.138308116449064322, 0.140785949814968309, 0.143274978974047118, 0.145775208006537926,</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>            0.148286642733128721, 0.150809290682410169, 0.153343161060837674, 0.155888264725064563,</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>            0.158444614156520225, 0.161012223438117663, 0.163591108232982951, 0.166181285765110071,</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>            0.168782774801850333, 0.171395595638155623, 0.174019770082499359, 0.176655321444406654,</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>            0.179302274523530397, 0.181960655600216487, 0.184630492427504539, 0.187311814224516926,</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>            0.190004651671193070, 0.192709036904328807, 0.195425003514885592, 0.198152586546538112,</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>            0.200891822495431333, 0.203642749311121501, 0.206405406398679298, 0.209179834621935651,</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>            0.211966076307852941, 0.214764175252008499, 0.217574176725178370, 0.220396127481011589,</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>            0.223230075764789593, 0.226076071323264877, 0.228934165415577484, 0.231804410825248525,</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>            0.234686861873252689, 0.237581574432173676, 0.240488605941449107, 0.243408015423711988,</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>            0.246339863502238771, 0.249284212419516704, 0.252241126056943765, 0.255210669955677150,</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>            0.258192911338648023, 0.261187919133763713, 0.264195763998317568, 0.267216518344631837,</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>            0.270250256366959984, 0.273297054069675804, 0.276356989296781264, 0.279430141762765316,</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>            0.282516593084849388, 0.285616426816658109, 0.288729728483353931, 0.291856585618280984,</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>            0.294997087801162572, 0.298151326697901342, 0.301319396102034120, 0.304501391977896274,</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>            0.307697412505553769, 0.310907558127563710, 0.314131931597630143, 0.317370638031222396,</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>            0.320623784958230129, 0.323891482377732021, 0.327173842814958593, 0.330470981380537099,</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>            0.333783015832108509, 0.337110066638412809, 0.340452257045945450, 0.343809713148291340,</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>            0.347182563958251478, 0.350570941482881204, 0.353974980801569250, 0.357394820147290515,</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>            0.360830600991175754, 0.364282468130549597, 0.367750569780596226, 0.371235057669821344,</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>            0.374736087139491414, 0.378253817247238111, 0.381788410875031348, 0.385340034841733958,</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>            0.388908860020464597, 0.392495061461010764, 0.396098818517547080, 0.399720314981931668,</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>            0.403359739222868885, 0.407017284331247953, 0.410693148271983222, 0.414387534042706784,</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>            0.418100649839684591, 0.421832709231353298, 0.425583931339900579, 0.429354541031341519,</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>            0.433144769114574058, 0.436954852549929273, 0.440785034667769915, 0.444635565397727750,</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>            0.448506701509214067, 0.452398706863882505, 0.456311852680773566, 0.460246417814923481,</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>            0.464202689050278838, 0.468180961407822172, 0.472181538469883255, 0.476204732721683788,</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>            0.480250865911249714, 0.484320269428911598, 0.488413284707712059, 0.492530263646148658,</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>            0.496671569054796314, 0.500837575128482149, 0.505028667945828791, 0.509245245998136142,</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>            0.513487720749743026, 0.517756517232200619, 0.522052074674794864, 0.526374847174186700,</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>            0.530725304406193921, 0.535103932383019565, 0.539511234259544614, 0.543947731192649941,</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>            0.548413963257921133, 0.552910490428519918, 0.557437893621486324, 0.561996775817277916,</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>            0.566587763258951771, 0.571211506738074970, 0.575868682975210544, 0.580559996103683473,</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>            0.585286179266300333, 0.590047996335791969, 0.594846243770991268, 0.599681752622167719,</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>            0.604555390700549533, 0.609468064928895381, 0.614420723892076803, 0.619414360609039205,</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>            0.624450015550274240, 0.629528779928128279, 0.634651799290960050, 0.639820277456438991,</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>            0.645035480824251883, 0.650298743114294586, 0.655611470583224665, 0.660975147780241357,</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>            0.666391343912380640, 0.671861719900766374, 0.677388036222513090, 0.682972161648791376,</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>            0.688616083008527058, 0.694321916130032579, 0.700091918140490099, 0.705928501336797409,</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>            0.711834248882358467, 0.717811932634901395, 0.723864533472881599, 0.729995264565802437,</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>            0.736207598131266683, 0.742505296344636245, 0.748892447223726720, 0.755373506511754500,</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>            0.761953346841546475, 0.768637315803334831, 0.775431304986138326, 0.782341832659861902,</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>            0.789376143571198563, 0.796542330428254619, 0.803849483176389490, 0.811307874318219935,</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>            0.818929191609414797, 0.826726833952094231, 0.834716292992930375, 0.842915653118441077,</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>            0.851346258465123684, 0.860033621203008636, 0.869008688043793165, 0.878309655816146839,</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>            0.887984660763399880, 0.898095921906304051, 0.908726440060562912, 0.919991505048360247,</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>            0.932060075968990209, 0.945198953453078028, 0.959879091812415930, 0.977101701282731328,</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>            1.000000000000000000};</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        <span class="keywordflow">return</span> normF[i];</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    }</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>}</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="aandreasenhugevolatilityinterpl_8cpp_html_a18279dd4d4460f2130f7a45358c14ffa"><div class="ttname"><a href="../../d0/d70/andreasenhugevolatilityinterpl_8cpp.html#a18279dd4d4460f2130f7a45358c14ffa">y</a></div><div class="ttdeci">Real y</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d70/andreasenhugevolatilityinterpl_8cpp_source.html#l00046">andreasenhugevolatilityinterpl.cpp:46</a></div></div>
<div class="ttc" id="aclass_quant_lib_1_1_ziggurat_gaussian_rng_html"><div class="ttname"><a href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html">QuantLib::ZigguratGaussianRng</a></div><div class="ttdoc">Gaussian random number generator.</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcf/zigguratgaussianrng_8hpp_source.html#l00056">zigguratgaussianrng.hpp:56</a></div></div>
<div class="ttc" id="aclass_quant_lib_1_1_ziggurat_gaussian_rng_html_a089721060fd46fc8b6b97925aeda52b7"><div class="ttname"><a href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a089721060fd46fc8b6b97925aeda52b7">QuantLib::ZigguratGaussianRng::normF</a></div><div class="ttdeci">Real normF(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcf/zigguratgaussianrng_8hpp_source.html#l00206">zigguratgaussianrng.hpp:206</a></div></div>
<div class="ttc" id="aclass_quant_lib_1_1_ziggurat_gaussian_rng_html_a1dd1acca2b223c8da6c27cad720cfc7d"><div class="ttname"><a href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a1dd1acca2b223c8da6c27cad720cfc7d">QuantLib::ZigguratGaussianRng::next</a></div><div class="ttdeci">sample_type next() const</div><div class="ttdoc">returns a sample from a Gaussian distribution</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcf/zigguratgaussianrng_8hpp_source.html#l00064">zigguratgaussianrng.hpp:64</a></div></div>
<div class="ttc" id="aclass_quant_lib_1_1_ziggurat_gaussian_rng_html_a3024db4b1bb00939c4d6f485e33453a3"><div class="ttname"><a href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a3024db4b1bb00939c4d6f485e33453a3">QuantLib::ZigguratGaussianRng::normR</a></div><div class="ttdeci">Real normR() const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcf/zigguratgaussianrng_8hpp_source.html#l00130">zigguratgaussianrng.hpp:130</a></div></div>
<div class="ttc" id="aclass_quant_lib_1_1_ziggurat_gaussian_rng_html_a40d2462cc3a0aa4a8e8f28a78f5e630f"><div class="ttname"><a href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a40d2462cc3a0aa4a8e8f28a78f5e630f">QuantLib::ZigguratGaussianRng::normX</a></div><div class="ttdeci">Real normX(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcf/zigguratgaussianrng_8hpp_source.html#l00135">zigguratgaussianrng.hpp:135</a></div></div>
<div class="ttc" id="aclass_quant_lib_1_1_ziggurat_gaussian_rng_html_a83f8a4cb9abf4f592b57632e0db7130a"><div class="ttname"><a href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a83f8a4cb9abf4f592b57632e0db7130a">QuantLib::ZigguratGaussianRng::ZigguratTable</a></div><div class="ttdeci">Real ZigguratTable[257]</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcf/zigguratgaussianrng_8hpp_source.html#l00072">zigguratgaussianrng.hpp:72</a></div></div>
<div class="ttc" id="aclass_quant_lib_1_1_ziggurat_gaussian_rng_html_a9600c98697345efbe0a48b78b2700679"><div class="ttname"><a href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a9600c98697345efbe0a48b78b2700679">QuantLib::ZigguratGaussianRng::uint64Generator_</a></div><div class="ttdeci">RNG uint64Generator_</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcf/zigguratgaussianrng_8hpp_source.html#l00070">zigguratgaussianrng.hpp:70</a></div></div>
<div class="ttc" id="aclass_quant_lib_1_1_ziggurat_gaussian_rng_html_a97a3fedfd3fb15531808709d2e58073f"><div class="ttname"><a href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a97a3fedfd3fb15531808709d2e58073f">QuantLib::ZigguratGaussianRng::nextReal</a></div><div class="ttdeci">Real nextReal() const</div><div class="ttdoc">return a random number from a Gaussian distribution</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcf/zigguratgaussianrng_8hpp_source.html#l00085">zigguratgaussianrng.hpp:85</a></div></div>
<div class="ttc" id="aclass_quant_lib_1_1_ziggurat_gaussian_rng_html_a9bed188fd5d9a6679e94215c4cb25abe"><div class="ttname"><a href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#a9bed188fd5d9a6679e94215c4cb25abe">QuantLib::ZigguratGaussianRng::pdf</a></div><div class="ttdeci">Real pdf(Real x) const</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcf/zigguratgaussianrng_8hpp_source.html#l00125">zigguratgaussianrng.hpp:125</a></div></div>
<div class="ttc" id="aclass_quant_lib_1_1_ziggurat_gaussian_rng_html_ad0732c183c96fec5ad83c4b928085fa1"><div class="ttname"><a href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#ad0732c183c96fec5ad83c4b928085fa1">QuantLib::ZigguratGaussianRng::ZigguratGaussianRng</a></div><div class="ttdeci">ZigguratGaussianRng(const RNG &amp;uint64Generator)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcf/zigguratgaussianrng_8hpp_source.html#l00060">zigguratgaussianrng.hpp:60</a></div></div>
<div class="ttc" id="aclass_quant_lib_1_1_ziggurat_gaussian_rng_html_ad6ae312199547dfd98f3b79b89a036f0"><div class="ttname"><a href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#ad6ae312199547dfd98f3b79b89a036f0">QuantLib::ZigguratGaussianRng::sample_type</a></div><div class="ttdeci">Sample&lt; Real &gt; sample_type</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcf/zigguratgaussianrng_8hpp_source.html#l00058">zigguratgaussianrng.hpp:58</a></div></div>
<div class="ttc" id="aclass_quant_lib_1_1_ziggurat_gaussian_rng_html_adbbc2c4d9288520c41c9387719d80721"><div class="ttname"><a href="../../d1/db6/class_quant_lib_1_1_ziggurat_gaussian_rng.html#adbbc2c4d9288520c41c9387719d80721">QuantLib::ZigguratGaussianRng::zeroCase</a></div><div class="ttdeci">Real zeroCase(Real u) const</div><div class="ttdoc">compute a random number in the tail by hand</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dcf/zigguratgaussianrng_8hpp_source.html#l00113">zigguratgaussianrng.hpp:113</a></div></div>
<div class="ttc" id="agroup__types_html_ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78"><div class="ttname"><a href="../../d6/d59/group__types.html#ga4bdf4bfe76b9ffa6fa64c47d8bfa0c78">QuantLib::Real</a></div><div class="ttdeci">QL_REAL Real</div><div class="ttdoc">real number</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/de3/types_8hpp_source.html#l00050">types.hpp:50</a></div></div>
<div class="ttc" id="anamespace_quant_lib_html"><div class="ttname"><a href="../../d5/d7b/namespace_quant_lib.html">QuantLib</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d62/any_8hpp_source.html#l00037">any.hpp:37</a></div></div>
<div class="ttc" id="asample_8hpp_html"><div class="ttname"><a href="../../d5/de9/sample_8hpp.html">sample.hpp</a></div><div class="ttdoc">weighted sample</div></div>
<div class="ttc" id="astruct_quant_lib_1_1_sample_html"><div class="ttname"><a href="../../d4/da1/struct_quant_lib_1_1_sample.html">QuantLib::Sample</a></div><div class="ttdoc">weighted sample</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/de9/sample_8hpp_source.html#l00035">sample.hpp:35</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.9.5
</small></address>
</body>
</html>
